<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Events</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.eb66b6c2.css" as="style"><link rel="preload" href="/assets/js/app.0cb29436.js" as="script"><link rel="preload" href="/assets/js/2.ca99c19f.js" as="script"><link rel="preload" href="/assets/js/7.b7cf7cad.js" as="script"><link rel="prefetch" href="/assets/js/10.0e3b0b08.js"><link rel="prefetch" href="/assets/js/11.b6b33ded.js"><link rel="prefetch" href="/assets/js/12.60fb5e52.js"><link rel="prefetch" href="/assets/js/13.2e28db31.js"><link rel="prefetch" href="/assets/js/14.ffa650ea.js"><link rel="prefetch" href="/assets/js/15.721f3b34.js"><link rel="prefetch" href="/assets/js/16.d646b147.js"><link rel="prefetch" href="/assets/js/3.f217eac2.js"><link rel="prefetch" href="/assets/js/4.78dc510e.js"><link rel="prefetch" href="/assets/js/5.132338b4.js"><link rel="prefetch" href="/assets/js/6.046092bd.js"><link rel="prefetch" href="/assets/js/8.7c2d6c09.js"><link rel="prefetch" href="/assets/js/9.5931517b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.eb66b6c2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="content default"><h1 id="events"><a href="#events" aria-hidden="true" class="header-anchor">#</a> Events</h1> <p>Klaviyo Connect provides the following events you can use in your own custom plugin, to define your own custom mappings.</p> <h2 id="addprofilemapping"><a href="#addprofilemapping" aria-hidden="true" class="header-anchor">#</a> <code>addProfileMapping</code></h2> <p>Add a custom mapping for user profiles.</p> <h3 id="class-profilemapping"><a href="#class-profilemapping" aria-hidden="true" class="header-anchor">#</a> <code>class ProfileMapping</code></h3> <ul><li><code>name</code></li> <li><code>description</code></li> <li><code>handle</code> - A unique handle which Klaviyo Connect can associate the mapping with</li> <li><code>method</code> - The method in your plugin to call to execute the mapping. Receives array of form parameters as an argument.</li></ul> <h3 id="example"><a href="#example" aria-hidden="true" class="header-anchor">#</a> Example</h3> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">fostercommerce<span class="token punctuation">\</span>klaviyoconnect<span class="token punctuation">\</span>services<span class="token punctuation">\</span>Map</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">fostercommerce<span class="token punctuation">\</span>klaviyoconnect<span class="token punctuation">\</span>events<span class="token punctuation">\</span>AddProfileMappingEvent</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">fostercommerce<span class="token punctuation">\</span>klaviyoconnect<span class="token punctuation">\</span>models<span class="token punctuation">\</span>Profile</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">fostercommerce<span class="token punctuation">\</span>klaviyoconnect<span class="token punctuation">\</span>models<span class="token punctuation">\</span>ProfileMapping</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">yii<span class="token punctuation">\</span>base<span class="token punctuation">\</span>Event</span><span class="token punctuation">;</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

Event<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">on</span><span class="token punctuation">(</span>
  Map<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
  Map<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">EVENT_ADD_PROFILE_MAPPING</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span>AddProfileMappingEvent <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Define your mapping</span>
    <span class="token variable">$myMapping</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProfileMapping</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'My Custom Profile Mapping'</span><span class="token punctuation">,</span>
      <span class="token single-quoted-string string">'handle'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'mycustom_mapping'</span><span class="token punctuation">,</span>
      <span class="token single-quoted-string string">'description'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'A custom profile mapping'</span><span class="token punctuation">,</span>
      <span class="token single-quoted-string string">'method'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$profile</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Profile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Perform profile mapping...</span>
        <span class="token keyword">return</span> <span class="token variable">$profile</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Add it to list of mappings</span>
    <span class="token variable">$e</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">mappings</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$myMapping</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Use your custom mappings as you would the built-in ones:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>klaviyoProfileMapping<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mycustom_mapping<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h2 id="trackeventmapping-eventname"><a href="#trackeventmapping-eventname" aria-hidden="true" class="header-anchor">#</a> <code>trackEventMapping($eventName)</code></h2> <p>Add a custom mapper to set extra properties on an event. See the <code>extra</code> parameter in Event Form Parameters in <a href="/Actions.html">Actions</a></p> <h3 id="class-trackeventmappingevent"><a href="#class-trackeventmappingevent" aria-hidden="true" class="header-anchor">#</a> <code>class TrackEventMappingEvent</code></h3> <ul><li><code>properties</code> - Custom properties to pass through to Klaviyo with the tracked event.</li></ul> <h3 id="example-2"><a href="#example-2" aria-hidden="true" class="header-anchor">#</a> Example</h3> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">fostercommerce<span class="token punctuation">\</span>klaviyoconnect<span class="token punctuation">\</span>controllers<span class="token punctuation">\</span>ApiController</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">fostercommerce<span class="token punctuation">\</span>klaviyoconnect<span class="token punctuation">\</span>events<span class="token punctuation">\</span>TrackEventMappingEvent</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">fostercommerce<span class="token punctuation">\</span>klaviyoconnect<span class="token punctuation">\</span>models<span class="token punctuation">\</span>EventProperties</span><span class="token punctuation">;</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

Event<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">on</span><span class="token punctuation">(</span>
  ApiController<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
  ApiController<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">EVENT_TRACK_EVENT_MAPPING</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span>TrackEventMappingEvent <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Add your custom event properties to the tracking data</span>
    <span class="token variable">$e</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">properties</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token single-quoted-string string">'Foo'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'Bar'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Note:</strong> Using this will overwrite any existing data in the <code>EventProperties::extra</code> field.</p> <h2 id="klaviyo-special-properties"><a href="#klaviyo-special-properties" aria-hidden="true" class="header-anchor">#</a> Klaviyo Special Properties</h2> <p>The Klaviyo API includes the following special properties via HTTP.</p> <h3 id="user-profile-properties"><a href="#user-profile-properties" aria-hidden="true" class="header-anchor">#</a> User Profile Properties</h3> <ul><li><code>$id</code> - your unique identifier for a person</li> <li><code>$email</code> - email address</li> <li><code>$first_name</code> - first name</li> <li><code>$last_name</code> - last name</li> <li><code>$phone_number</code> - phone number</li> <li><code>$title</code> - title at their business or organization</li> <li><code>$organization</code> - business or organization they belong to</li> <li><code>$city</code> - city they live in</li> <li><code>$region</code> - region or state they live in</li> <li><code>$country</code> - country they live in</li> <li><code>$zip</code> - postal code where they live</li> <li><code>$image</code> - url to a photo of the person</li></ul> <h3 id="event-properties"><a href="#event-properties" aria-hidden="true" class="header-anchor">#</a> Event Properties</h3> <ul><li><code>$event_id</code> - an unique identifier for an event</li> <li><code>$value</code> - a numeric value to associate with this event (e.g. the dollar value of a purchase)</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0cb29436.js" defer></script><script src="/assets/js/2.ca99c19f.js" defer></script><script src="/assets/js/7.b7cf7cad.js" defer></script>
  </body>
</html>
